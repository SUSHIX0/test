<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Оплата через Stripe</title>
<script src="https://js.stripe.com/v3/"></script>
</head>
<body>

<h1>Введите сумму для оплаты</h1>
<input type="number" id="amount" placeholder="Сумма в USD" min="1" step="0.01">
<button id="checkout-button">Оплатить</button>

<script>
const button = document.getElementById('checkout-button');
button.addEventListener('click', async () => {
  const amount = parseFloat(document.getElementById('amount').value);
  if (!amount || amount <= 0) return alert("Введите корректную сумму");

  try {
    const res = await fetch('http://localhost:4242/create-checkout-session', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ amount })
    });
    const data = await res.json();

    const stripe = Stripe('pk_test_51SfNiQHUK59B1PYZej8zznYaX1ruzddFaxVaU8UdkRUwLAmzX11oO0Fu0oas99ntP1yRH2hpE8FzVWo6CpOffgsc00YrpFiaAk'); // Публичный ключ
    stripe.redirectToCheckout({ sessionId: data.id });
  } catch(err) {
    console.error(err);
    alert("Ошибка при создании платежа");
  }
});
</script>

</body>
</html>
